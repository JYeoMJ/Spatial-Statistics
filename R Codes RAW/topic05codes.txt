##Example 1 (Dataset plots)

library(spatstat)
data(japanesepines)
data(redwood)
data(cells)
opar <- par(mfrow=c(1,3))
plot(japanesepines, main="Japanese Pines")
plot(redwood, main="Redwood Seedlings")
plot(cells, main="Cell Centre")

##Example 2 (CSR plots)

opar <- par(mfrow=c(2,3), mar=rep(0.5,4))
for(i in 1:6){
	pp <- rpoispp(100)
	plot(pp, main="")
	}

##Example 3 (Envelopes for G)

envjap <- envelope(japanesepines, Gest, nrank=2, nsim=99, verbose=FALSE)
plot(envjap, obs~theo)

envred <- envelope(redwood, Gest, nrank=2, nsim=99, verbose=FALSE)
plot(envred, obs~theo)

envcells <- envelope(cells, Gest, nrank=2, nsim=99, verbose=FALSE)
plot(envcells, obs~theo)

##Example 4 (Envelopes for F)

envjap <- envelope(japanesepines, Fest, nrank=2, nsim=99, verbose=FALSE)
plot(envjap, obs~theo)

envred <- envelope(redwood, Fest, nrank=2, nsim=99, verbose=FALSE)
plot(envred, obs~theo)

envcells <- envelope(cells, Fest, nrank=2, nsim=99, verbose=FALSE)
plot(envcells, obs~theo)

##Example 5 (Quadrat test)

qj <- quadratcount(japanesepines,nx=3)
plot(japanesepines, pch="+")
plot(qj, add=TRUE, col="red")
quadrat.test(japanesepines,nx=3)

qr <- quadratcount(redwood,nx=3)
plot(redwood, pch="+")
plot(qr, add=TRUE, col="red")
quadrat.test(redwood,nx=3)

qc <- quadratcount(cells,nx=3)
plot(cells, pch="+")
plot(qc, add=TRUE, col="red")
quadrat.test(cells,nx=3)

##Example 6 (Kernel smoothing of intensity)

bd=bw.diggle(redwood)
bd
bs=bw.scott(redwood)
bs
opar <- par(mfrow=c(1,2))
plot(density(redwood,bd),main="Diggle")
plot(redwood,add=TRUE,col="white")
plot(density(redwood,bs),main="Scott")
plot(redwood,add=TRUE,col="white")

##Example 7 (Polynomial model)

ppm(bei,~polynom(x,y,2))

##Example 8 (Using slope as covariate)

slope <- bei.extra$grad
ppm(bei,~slope)

##Example 9 (Plotting intensity)

fit <- ppm(bei,~x+y)
plot(fit,how="image",se=FALSE)

##Example 10 (Model selection)

fit <- ppm(bei,~slope)
fitnull <- ppm(bei,~1)
anova(fitnull,fit,test="Chi")
AIC(fit)
AIC(fitnull)

##Example 11 (Goodness of fit)

fit <- ppm(bei, ~x)
M <- quadrat.test(fit, nx=4, ny=2)
plot(bei, pch=".")
plot(M, add=TRUE, col="red")

##Example 12 (Plots of L function)

opar <- par(mfrow=c(1,3))
L <- envelope(japanesepines, Lest, nsim=99, verbose=FALSE)
plot(L, main="Jap pines")
L <- envelope(redwood, Lest, nsim=99, verbose=FALSE)
plot(L, main="Redwood")
L <- envelope(cells, Lest, nsim=99, verbose=FALSE)
plot(L, main="Cells")

##Example 13 (Plot of K_inhom)

fit <- ppm(bei, ~elev+grad, covariates=bei.extra)
lam <- predict(fit, locations = bei)
Ki <- Kinhom(bei, lam, verbose=FALSE) 
plot(Ki, main="Inhomogeneous K")






